{"ast":null,"code":"import _objectSpread from\"C:/gitHub/retube-reactApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/gitHub/retube-reactApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/gitHub/retube-reactApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/gitHub/retube-reactApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/gitHub/retube-reactApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import*as React from\"react\";import{findVideoClipIndexForId,copy,getStorage,setStorage,cleanDeprecatedStorage,arrayShuffle}from\"./utils\";import db from\"./db\";import{jsx as _jsx}from\"react/jsx-runtime\";var NAME_LOCALSTORAGE=\"dbYoutubeReact\";var VERSION_LOCALSTORAGE=\"3\";var KEY_LOCALSTORAGE=NAME_LOCALSTORAGE+VERSION_LOCALSTORAGE;var Context=/*#__PURE__*/React.createContext({});var AppProvider=/*#__PURE__*/function(_React$Component){_inherits(AppProvider,_React$Component);var _super=_createSuper(AppProvider);function AppProvider(props){var _this;_classCallCheck(this,AppProvider);_this=_super.call(this,props);_this.state=void 0;_this.setState=void 0;_this.props=void 0;_this.resetDatabase=function(){_this.setState({playlist:copy(arrayShuffle(db))},_this.updateStorage);};_this.setIdVideo=function(idVideo){_this.setState({idVideo:idVideo});};_this.setInFullPlayer=function(inFullPlayer){_this.setState({inFullPlayer:inFullPlayer});};_this.removePlaylistItem=function(id){var playlist=_this.state.playlist.filter(function(item){return item.id!==id;});_this.setState({playlist:playlist},_this.updateStorage);};_this.addPlaylistItem=function(videoClip){var list=_this.state.playlist.slice();list.push(videoClip);_this.setState({playlist:list},_this.updateStorage);};_this.updatePlaylistItem=function(id,videoClip){var playlist=_this.state.playlist.slice();var index=findVideoClipIndexForId(playlist,id);playlist[index]=_objectSpread(_objectSpread({},playlist[index]),videoClip);_this.setState({playlist:playlist},_this.updateStorage);};_this.setRepeat=function(repeat){_this.setState({repeat:repeat},_this.updateStorage);};_this.setRandom=function(random){_this.setState({random:random},_this.updateStorage);};_this.setAutoPlaylist=function(autoPlaylist){_this.setState({autoPlaylist:autoPlaylist},_this.updateStorage);};_this.setTheaterMode=function(theaterMode){_this.setState({theaterMode:theaterMode},_this.updateStorage);};_this.updateStorage=function(){setStorage(KEY_LOCALSTORAGE,_this.state);};var state;var cacheState=getStorage(KEY_LOCALSTORAGE);cleanDeprecatedStorage(NAME_LOCALSTORAGE,VERSION_LOCALSTORAGE);if(cacheState){state=_objectSpread(_objectSpread({},cacheState),{},{idVideo:\"\"});}else{state={autoPlaylist:true,idVideo:\"\",inFullPlayer:false,playlist:copy(arrayShuffle(db)),random:false,repeat:false,theaterMode:false};setStorage(KEY_LOCALSTORAGE,state);}_this.state=state;return _this;}_createClass(AppProvider,[{key:\"render\",value:function render(){var value=_objectSpread(_objectSpread({},this.state),{},{addVideoClip:this.addPlaylistItem,removePlaylistItem:this.removePlaylistItem,resetDatabase:this.resetDatabase,setAutoPlaylist:this.setAutoPlaylist,setIdVideo:this.setIdVideo,setInFullPlayer:this.setInFullPlayer,setRandom:this.setRandom,setRepeat:this.setRepeat,setTheaterMode:this.setTheaterMode,setVideoClip:this.updatePlaylistItem});return/*#__PURE__*/_jsx(Context.Provider,_objectSpread({value:value},this.props));}}]);return AppProvider;}(React.Component);AppProvider.Consumer=Context.Consumer;export{AppProvider as default};","map":{"version":3,"sources":["C:/gitHub/retube-reactApp/src/AppProvider.tsx"],"names":["React","findVideoClipIndexForId","copy","getStorage","setStorage","cleanDeprecatedStorage","arrayShuffle","db","NAME_LOCALSTORAGE","VERSION_LOCALSTORAGE","KEY_LOCALSTORAGE","Context","createContext","AppProvider","props","state","setState","resetDatabase","playlist","updateStorage","setIdVideo","idVideo","setInFullPlayer","inFullPlayer","removePlaylistItem","id","filter","item","addPlaylistItem","videoClip","list","slice","push","updatePlaylistItem","index","setRepeat","repeat","setRandom","random","setAutoPlaylist","autoPlaylist","setTheaterMode","theaterMode","cacheState","value","addVideoClip","setVideoClip","Component","Consumer"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport { IVideoClip, IVideoClipOptional } from \"./components\";\r\nimport {\r\n  findVideoClipIndexForId,\r\n  copy,\r\n  getStorage,\r\n  setStorage,\r\n  cleanDeprecatedStorage,\r\n  arrayShuffle,\r\n} from \"./utils\";\r\nimport db from \"./db\";\r\n\r\nconst NAME_LOCALSTORAGE = \"dbYoutubeReact\";\r\nconst VERSION_LOCALSTORAGE = \"3\";\r\n\r\nconst KEY_LOCALSTORAGE = NAME_LOCALSTORAGE + VERSION_LOCALSTORAGE;\r\n\r\nconst Context = React.createContext({});\r\n\r\nexport interface IState {\r\n  idVideo: string;\r\n  inFullPlayer: boolean;\r\n  playlist: IVideoClip[];\r\n  autoPlaylist: boolean;\r\n  random: boolean;\r\n  repeat: boolean;\r\n  theaterMode: boolean; // TODO: theater Mode\r\n}\r\n\r\nexport interface IAppProvider extends IState {\r\n  resetDatabase: () => void;\r\n  removePlaylistItem: (id: string) => void;\r\n  setIdVideo: (idVideo: string) => void;\r\n  setInFullPlayer: (inFullPlayer: boolean) => void;\r\n  setVideoClip: (id: string, videoClip: IVideoClipOptional) => void;\r\n  addVideoClip: (videoClip: IVideoClip) => void;\r\n  setAutoPlaylist: (autoPlay: boolean) => void;\r\n  setRandom: (random: boolean) => void;\r\n  setRepeat: (repeat: boolean) => void;\r\n  setTheaterMode: (theaterMode: boolean) => void;\r\n}\r\n\r\nexport default class AppProvider extends React.Component<any, IState> {\r\n  public static Consumer = Context.Consumer;\r\n  state: IState;\r\n  setState: any;\r\n  props: unknown;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    let state: IState;\r\n\r\n    const cacheState = getStorage(KEY_LOCALSTORAGE);\r\n    cleanDeprecatedStorage(NAME_LOCALSTORAGE, VERSION_LOCALSTORAGE);\r\n    if (cacheState) {\r\n      state = {\r\n        ...cacheState,\r\n        idVideo: \"\",\r\n      };\r\n    } else {\r\n      state = {\r\n        autoPlaylist: true,\r\n        idVideo: \"\",\r\n        inFullPlayer: false,\r\n        playlist: copy(arrayShuffle(db)),\r\n        random: false,\r\n        repeat: false,\r\n        theaterMode: false,\r\n      };\r\n      setStorage(KEY_LOCALSTORAGE, state);\r\n    }\r\n    this.state = state;\r\n  }\r\n\r\n  public resetDatabase = () => {\r\n    this.setState(\r\n      {\r\n        playlist: copy(arrayShuffle(db)),\r\n      },\r\n      this.updateStorage\r\n    );\r\n  };\r\n\r\n  public setIdVideo = (idVideo: string) => {\r\n    this.setState({\r\n      idVideo,\r\n    });\r\n  };\r\n\r\n  public setInFullPlayer = (inFullPlayer: boolean) => {\r\n    this.setState({\r\n      inFullPlayer,\r\n    });\r\n  };\r\n\r\n  public removePlaylistItem = (id: string) => {\r\n    const playlist = this.state.playlist.filter((item) => item.id !== id);\r\n    this.setState({ playlist }, this.updateStorage);\r\n  };\r\n\r\n  public addPlaylistItem = (videoClip: IVideoClip) => {\r\n    const list = this.state.playlist.slice();\r\n    list.push(videoClip);\r\n\r\n    this.setState(\r\n      {\r\n        playlist: list,\r\n      },\r\n      this.updateStorage\r\n    );\r\n  };\r\n\r\n  public updatePlaylistItem = (id: string, videoClip: IVideoClipOptional) => {\r\n    const playlist = this.state.playlist.slice();\r\n    const index = findVideoClipIndexForId(playlist, id);\r\n    playlist[index] = {\r\n      ...playlist[index],\r\n      ...videoClip,\r\n    };\r\n\r\n    this.setState(\r\n      {\r\n        playlist,\r\n      },\r\n      this.updateStorage\r\n    );\r\n  };\r\n\r\n  public setRepeat = (repeat: boolean) => {\r\n    this.setState({ repeat }, this.updateStorage);\r\n  };\r\n\r\n  public setRandom = (random: boolean) => {\r\n    this.setState({ random }, this.updateStorage);\r\n  };\r\n\r\n  public setAutoPlaylist = (autoPlaylist: boolean) => {\r\n    this.setState({ autoPlaylist }, this.updateStorage);\r\n  };\r\n\r\n  public setTheaterMode = (theaterMode: boolean) => {\r\n    this.setState({ theaterMode }, this.updateStorage);\r\n  };\r\n\r\n  public render() {\r\n    const value: IAppProvider = {\r\n      ...this.state,\r\n      addVideoClip: this.addPlaylistItem,\r\n      removePlaylistItem: this.removePlaylistItem,\r\n      resetDatabase: this.resetDatabase,\r\n      setAutoPlaylist: this.setAutoPlaylist,\r\n      setIdVideo: this.setIdVideo,\r\n      setInFullPlayer: this.setInFullPlayer,\r\n      setRandom: this.setRandom,\r\n      setRepeat: this.setRepeat,\r\n      setTheaterMode: this.setTheaterMode,\r\n      setVideoClip: this.updatePlaylistItem,\r\n    };\r\n\r\n    return <Context.Provider value={value} {...this.props} />;\r\n  }\r\n\r\n  private updateStorage = () => {\r\n    setStorage(KEY_LOCALSTORAGE, this.state);\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}